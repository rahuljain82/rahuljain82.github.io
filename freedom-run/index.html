<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Freedom Run - Running Ninjas</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      font-family: 'Inter', system-ui, sans-serif;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
      background: #000;
    }
    
    .fullscreen-container {
      position: relative;
      height: 100vh;
      width: 100vw;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: zoom-in;
    }
    
    .fullscreen-image {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      transition: transform 0.3s ease;
    }
    
    .fullscreen-image:hover {
      transform: scale(1.02);
    }
    
    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.9);
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: 14px;
      color: #333;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .back-button:hover {
      background: rgba(255, 255, 255, 1);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }
    
    .page-title {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 12px 20px;
      border-radius: 25px;
      font-family: 'Inter', sans-serif;
      font-weight: 700;
      font-size: 16px;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    .register-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 1000;
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      border: none;
      padding: 15px 25px;
      border-radius: 30px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-weight: 700;
      font-size: 16px;
      box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
      transition: all 0.3s ease;
      animation: pulse 2s infinite;
    }
    
    .register-button:hover {
      background: linear-gradient(135deg, #ee5a24, #ff6b6b);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
    }
    
    @keyframes pulse {
      0% {
        box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
      }
      50% {
        box-shadow: 0 4px 25px rgba(255, 107, 107, 0.7);
      }
      100% {
        box-shadow: 0 4px 20px rgba(255, 107, 107, 0.4);
      }
    }
    
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
    }
    
    .modal-content {
      background-color: white;
      margin: 10% auto;
      padding: 30px;
      border-radius: 20px;
      width: 90%;
      max-width: 450px;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.3s ease-out;
    }
    
    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      position: absolute;
      right: 20px;
      top: 15px;
      cursor: pointer;
    }
    
    .close:hover {
      color: #000;
    }
    
    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: #333;
      margin-bottom: 20px;
      text-align: center;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .form-input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e1e8ed;
      border-radius: 10px;
      font-size: 16px;
      font-family: 'Inter', sans-serif;
      transition: border-color 0.3s ease;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #ff6b6b;
    }
    
    .form-input.error {
      border-color: #e74c3c;
    }
    
    .error-text {
      color: #e74c3c;
      font-size: 12px;
      margin-top: 5px;
      display: none;
    }
    
    .submit-button {
      width: 100%;
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      color: white;
      border: none;
      padding: 15px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }
    
    .submit-button:hover {
      background: linear-gradient(135deg, #ee5a24, #ff6b6b);
      transform: translateY(-2px);
    }
    
    .submit-button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .success-message {
      background: #27ae60;
      color: white;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin-bottom: 20px;
      display: none;
    }
    
    .runner-count {
      position: fixed;
      bottom: 30px;
      left: 30px;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.95);
      color: #333;
      border: 2px solid #ff6b6b;
      padding: 12px 20px;
      border-radius: 25px;
      font-family: 'Inter', sans-serif;
      font-weight: 700;
      font-size: 14px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      gap: 8px;
      animation: countPulse 3s infinite;
    }
    
    .runner-count .count-number {
      color: #ff6b6b;
      font-size: 16px;
      font-weight: 800;
    }
    
    .runner-count .loading-dots {
      display: none;
      font-size: 12px;
      opacity: 0.7;
    }
    
    .runner-count.loading .loading-dots {
      display: inline;
    }
    
    .runner-count.loading .count-text {
      display: none;
    }
    
    .runner-count.loading {
      opacity: 0.8;
      transform: scale(0.95);
    }
    
    @keyframes countPulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }
    
    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 18px;
      font-weight: 600;
    }
    
    .error-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      text-align: center;
      padding: 20px;
    }
    
    .error-message h2 {
      font-size: 24px;
      margin-bottom: 10px;
      color: #ff6b6b;
    }
    
    .error-message p {
      font-size: 16px;
      opacity: 0.8;
    }
    
    @media (max-width: 768px) {
      .back-button {
        top: 15px;
        left: 15px;
        padding: 10px 16px;
        font-size: 12px;
      }
      
      .page-title {
        top: 15px;
        right: 15px;
        padding: 10px 16px;
        font-size: 14px;
      }
      
      .register-button {
        bottom: 20px;
        right: 20px;
        padding: 12px 20px;
        font-size: 14px;
      }
      
      .modal-content {
        margin: 5% auto;
        padding: 20px;
        width: 95%;
      }
      
      .runner-count {
        bottom: 20px;
        left: 20px;
        padding: 10px 16px;
        font-size: 12px;
      }
      
      .runner-count .count-number {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-button">
    <span>‚Üê</span>
    <span>Back to Home</span>
  </a>
  
  <div class="page-title">Freedom Run</div>
  
  <button class="register-button" id="registerBtn">Register Interest</button>
  
  <div class="runner-count" id="runnerCount">
    <div class="count-text">
      <span class="count-number" id="countNumber">0</span> 
      <span>runners registered</span>
    </div>
    <div class="loading-dots">Loading...</div>
  </div>
  
  <div class="fullscreen-container">
    <div class="loading" id="loading">Loading image...</div>
    <img 
      id="freedomImage" 
      class="fullscreen-image" 
      src="https://i.ibb.co/vv4q0yFC/Whats-App-Image-2025-08-14-at-11-02-15.jpg"
      alt="Freedom Run" 
      style="display: none;"
      onload="imageLoaded()"
      onerror="imageError()"
    />
    <div class="error-message" id="errorMessage" style="display: none;">
      <h2>Image Failed to Load</h2>
      <p>Sorry, we couldn't load the Freedom Run image. Please try refreshing the page.</p>
    </div>
  </div>

  <!-- Registration Modal -->
  <div id="registerModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 class="modal-title">Register Your Interest</h2>
      <div id="successMessage" class="success-message">
        Registration successful! We'll see you running :-).
      </div>
      <form id="registerForm">
        <div class="form-group">
          <label for="userName" class="form-label">Your Name *</label>
          <input type="text" id="userName" class="form-input" placeholder="Enter your full name" required>
          <div class="error-text" id="nameError">Please enter your name</div>
        </div>
        <div class="form-group">
          <label for="flatNumber" class="form-label">Flat Number *</label>
          <input type="text" id="flatNumber" class="form-input" placeholder="Enter your flat number" required>
          <div class="error-text" id="flatError">Please enter your flat number</div>
        </div>
        <button type="submit" class="submit-button" id="submitBtn">
          Register Interest
        </button>
      </form>
    </div>
  </div>

  <script>
    function imageLoaded() {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('freedomImage').style.display = 'block';
      document.getElementById('errorMessage').style.display = 'none';
      
      // Load runner count after image is loaded
      setTimeout(fetchRunnerCount, 200);
    }
    
    function imageError() {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('freedomImage').style.display = 'none';
      document.getElementById('errorMessage').style.display = 'block';
    }
    
    // Optional: Add click to zoom functionality
    document.getElementById('freedomImage').addEventListener('click', function() {
      if (this.style.transform === 'scale(1.5)') {
        this.style.transform = 'scale(1)';
        this.style.cursor = 'zoom-in';
      } else {
        this.style.transform = 'scale(1.5)';
        this.style.cursor = 'zoom-out';
      }
    });
    
    // Reset zoom on window resize
    window.addEventListener('resize', function() {
      const img = document.getElementById('freedomImage');
      img.style.transform = 'scale(1)';
      img.style.cursor = 'zoom-in';
    });

    // Modal functionality
    const modal = document.getElementById('registerModal');
    const registerBtn = document.getElementById('registerBtn');
    const closeBtn = document.getElementsByClassName('close')[0];
    const form = document.getElementById('registerForm');
    const submitBtn = document.getElementById('submitBtn');
    const successMessage = document.getElementById('successMessage');

    // Google Sheets Web App URL (you'll need to replace this with your actual URL)
    const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbxcF0QA7a0SaRRDgch22sozhrPJi-ZBaFqmICjKSvLhF8tz3je2QFseYWteQ_v60aRq/exec';

    // Counter elements
    const runnerCount = document.getElementById('runnerCount');
    const countNumber = document.getElementById('countNumber');

    // Open modal
    registerBtn.onclick = function() {
      modal.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    // Close modal
    closeBtn.onclick = closeModal;
    window.onclick = function(event) {
      if (event.target == modal) {
        closeModal();
      }
    }

    function closeModal() {
      modal.style.display = 'none';
      document.body.style.overflow = 'hidden';
      resetForm();
    }

    function resetForm() {
      form.reset();
      successMessage.style.display = 'none';
      clearErrors();
    }

    function clearErrors() {
      const inputs = document.querySelectorAll('.form-input');
      const errors = document.querySelectorAll('.error-text');
      
      inputs.forEach(input => input.classList.remove('error'));
      errors.forEach(error => error.style.display = 'none');
    }

    function validateForm() {
      const name = document.getElementById('userName').value.trim();
      const flatNumber = document.getElementById('flatNumber').value.trim();
      let isValid = true;

      clearErrors();

      if (!name) {
        document.getElementById('userName').classList.add('error');
        document.getElementById('nameError').style.display = 'block';
        isValid = false;
      }

      if (!flatNumber) {
        document.getElementById('flatNumber').classList.add('error');
        document.getElementById('flatError').style.display = 'block';
        isValid = false;
      }

      return isValid;
    }

    // Form submission
    form.onsubmit = async function(e) {
      e.preventDefault();
      
      if (!validateForm()) {
        return;
      }

      const name = document.getElementById('userName').value.trim();
      const flatNumber = document.getElementById('flatNumber').value.trim();

      // Disable submit button and show loading state
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';

      try {
        // Create the data object
        const formData = {
          name: name,
          flatNumber: flatNumber,
          timestamp: new Date().toISOString(),
          event: 'Freedom Run'
        };

        // For now, we'll use a placeholder function. 
        // You'll need to replace this with your actual Google Sheets integration
        await submitToGoogleSheets(formData);

        // Show success message
        successMessage.style.display = 'block';
        form.style.display = 'none';

        // Update the counter
        incrementCount();

        // Close modal after 2 seconds
        setTimeout(() => {
          closeModal();
          form.style.display = 'block';
        }, 2000);

      } catch (error) {
        console.error('Submission error:', error);
        alert('Sorry, there was an error submitting your registration. Please try again.');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Register Interest';
      }
    }

    // Google Sheets submission function
    async function submitToGoogleSheets(data) {
      // This is a placeholder function. You'll need to set up a Google Apps Script
      // and replace the URL below with your actual Google Sheets Web App URL
      
      if (GOOGLE_SHEETS_URL === 'YOUR_GOOGLE_SHEETS_WEB_APP_URL_HERE') {
        // For testing purposes, simulate a successful submission
        console.log('Test submission:', data);
        await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate network delay
        return;
      }

      const response = await fetch(GOOGLE_SHEETS_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
      });

      // Note: With no-cors mode, we can't check response status
      // The request will appear to succeed even if it fails
      return response;
    }

    // Function to fetch runner count
    async function fetchRunnerCount() {
      try {
        // Only show loading state briefly, don't interfere with image loading
        const loadingTimeout = setTimeout(() => {
          runnerCount.classList.add('loading');
        }, 100);
        
        const response = await fetch(GOOGLE_SHEETS_URL);
        const data = await response.json();
        
        clearTimeout(loadingTimeout);
        runnerCount.classList.remove('loading');
        
        const count = data.count || 0;
        countNumber.textContent = count;
        
        // Update text for singular/plural
        const textSpan = runnerCount.querySelector('.count-text span:last-child');
        textSpan.textContent = count === 1 ? 'runner registered' : 'runners registered';
        
      } catch (error) {
        console.error('Error fetching runner count:', error);
        runnerCount.classList.remove('loading');
        countNumber.textContent = '?';
      }
    }

    // Function to update count after successful registration
    function incrementCount() {
      const currentCount = parseInt(countNumber.textContent) || 0;
      const newCount = currentCount + 1;
      countNumber.textContent = newCount;
      
      // Update text for singular/plural
      const textSpan = runnerCount.querySelector('.count-text span:last-child');
      textSpan.textContent = newCount === 1 ? 'runner registered' : 'runners registered';
      
      // Add a brief animation
      runnerCount.style.transform = 'scale(1.1)';
      setTimeout(() => {
        runnerCount.style.transform = 'scale(1)';
      }, 200);
    }

    // Count is now loaded after image loads (see imageLoaded function)
  </script>
</body>
</html>